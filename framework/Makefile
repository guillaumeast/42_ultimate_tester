NAME			:= tester
CC				:= cc
CFLAGS			:= -Wall -Wextra

# Project paths (TMP: auto-generated by script in prod)
PROJECT_DIR		:= /Users/gui/repos/printf
PROJECT_LIB		:= $(PROJECT_DIR)/libftprintf.a
PROJECT_INC_DIR	:= $(PROJECT_DIR)/includes

PREBUILD_DIR	:= prebuild
SRCS			= $(wildcard srcs/*c) $(wildcard $(PREBUILD_DIR)/outputs/*c)
INCLUDES		:= -Iincludes -I$(PROJECT_INC_DIR)

OBJ_DIR			:= obj
OBJS			:= $(SRCS:%.c=$(OBJ_DIR)/%.o)

all: 
	@make -C $(PREBUILD_DIR)
	@make build

build: $(NAME)
	@./$(NAME)

$(PROJECT_LIB):
	@make -C $(PROJECT_DIR)

$(NAME): $(OBJS) $(PROJECT_LIB)
	$(CC) $(CFLAGS) $(INCLUDES) -o $(NAME) $(OBJS) $(PROJECT_LIB)

$(OBJ_DIR)/%.o : %.c
	@mkdir -p $(dir $@)
	$(CC) $(CFLAGS) $(INCLUDES) -c $< -o $@

clean:
	@make -C $(PREBUILD_DIR) clean
	@rm -rf $(OBJ_DIR)

fclean: clean
	@make -C $(PREBUILD_DIR) fclean
	@rm -f $(NAME)

re: fclean all

.PHONY: all prebuild clean fclean re run
